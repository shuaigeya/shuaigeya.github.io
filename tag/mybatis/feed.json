{
    "version": "https://jsonfeed.org/version/1",
    "title": "Hexo • All posts by \"mybatis\" tag",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2022/06/29/myBatis-%E9%9D%A2%E8%AF%95%E9%A2%98/",
            "url": "http://example.com/2022/06/29/myBatis-%E9%9D%A2%E8%AF%95%E9%A2%98/",
            "title": "myBatis 面试题",
            "date_published": "2022-06-29T04:27:11.000Z",
            "content_html": "<p>Mybatis 中文网：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9teWJhdGlzLm5ldC5jbi8=\">请戳此</span></p>\n<h2 id=\"mybatis-缓存\"><a class=\"markdownIt-Anchor\" href=\"#mybatis-缓存\">#</a> MyBatis 缓存</h2>\n<p><strong>缓存</strong>：暂存一些数据，加快系统查询速度。</p>\n<p><strong>Mybatis 缓存机制</strong>：本质是一个<strong> Map</strong>, 能保存一些数据。</p>\n<p><strong>一级缓存</strong>：线程级别的缓存。也称本地缓存或<strong> sqlSession</strong> 级别的缓存。（和数据库的一次会话就有一次一级缓存）</p>\n<p><strong>二级缓存</strong>：全局范围的缓存。（除了当前线程和<strong> SqlSession</strong> 能用外，其他的都能用）</p>\n<h3 id=\"一级缓存\"><a class=\"markdownIt-Anchor\" href=\"#一级缓存\">#</a> 一级缓存</h3>\n<p>只要之前查询过的数据，<strong>MyBatis</strong> 都会保存在缓存中，下次获取这些数据，都会直接在缓存中拿。</p>\n<blockquote>\n<p>注：<strong>SpringBoot + Mybatis 一级缓存会失效</strong>。原因是经过 Spring 的处理，每次查询完成后，都会关闭<strong> sqlSession</strong>，而一级缓存是<strong> sqlSession</strong> 级别的缓存。</p>\n</blockquote>\n<h4 id=\"缓存失效的几种情况\"><a class=\"markdownIt-Anchor\" href=\"#缓存失效的几种情况\">#</a> 缓存失效的几种情况</h4>\n<ol>\n<li>不同的 <strong>sqlSession</strong> ，同一级的缓存。</li>\n<li>同一个方法，不同的参数。</li>\n<li>在同一个<strong> sqlSession</strong> 期间执行过任何一次增删改操作。</li>\n<li>手动清空了缓存。</li>\n</ol>\n<h3 id=\"二级缓存\"><a class=\"markdownIt-Anchor\" href=\"#二级缓存\">#</a> 二级缓存</h3>\n<blockquote>\n<p>二级缓存没有，就去看一级缓存，一级缓存没有，就去读数据库。<br>\n关闭 <strong>sqlSession</strong> 会把一级缓存数据放在二级缓存中。</p>\n</blockquote>\n<h2 id=\"mybatis-动态标签\"><a class=\"markdownIt-Anchor\" href=\"#mybatis-动态标签\">#</a> MyBatis 动态标签</h2>\n<blockquote>\n<p><strong>if、where、trim、set、foreach、collection、choose、sql、include、bing</strong></p>\n</blockquote>\n<h3 id=\"if-类似java中单分支-if-判断\"><a class=\"markdownIt-Anchor\" href=\"#if-类似java中单分支-if-判断\">#</a> if : 类似 java 中单分支  if  判断</h3>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT</span><br><span class=\"line\">*</span><br><span class=\"line\">FROM</span><br><span class=\"line\">\ttbl_navigation a</span><br><span class=\"line\">WHERE</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;obj.navigationId!=null and obj.navigationId!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">    a.column_type = #&#123;obj.navigationId&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;obj.id!=null and obj.id!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">    a.column_type = #&#123;obj.id&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"choose-when-otherwise\"><a class=\"markdownIt-Anchor\" href=\"#choose-when-otherwise\">#</a> choose、when、otherwise</h3>\n<blockquote>\n<p><strong>类似 Java 的 if-else。</strong><br>\n1. 当 title 不为空， 选择 title。<br>\n2. 当 content 不为空，title 为空，选择 content 。<br>\n3. 当 content 和 title 都为空，选择 otherwise。<br>\n4. 当 content 和 title 都为不为空，选择 title。</p>\n</blockquote>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from tbl_column</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">choose</span> &gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;obj.title != null&quot;</span>&gt;</span></span><br><span class=\"line\">                 and title like #&#123;obj.title&#125;</span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">&quot;content != null&quot;</span>&gt;</span></span><br><span class=\"line\">                 and content like #&#123;obj.content&#125;</span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">                 and delete = 1</span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"trim-where-set\"><a class=\"markdownIt-Anchor\" href=\"#trim-where-set\">#</a> trim、where、set</h3>\n<blockquote>\n<p><strong>where</strong>: 替换 sql 语句中的 where。只有当子元素有任何返回的情况，才会拼接 where。当子元素 以 or 或 and 开头 会去除。<br>\n<strong>trim</strong>: 可以去除 or 和 and，在语句中拼接前缀或后缀。<br>\n<strong>set</strong>: 替换 sql 语句中的 set。动态在行首添加 set 删除子元素首行逗号。</p>\n</blockquote>\n<h3 id=\"foreach\"><a class=\"markdownIt-Anchor\" href=\"#foreach\">#</a> foreach</h3>\n<blockquote>\n<p>类似 java 中的 foreach。<br>\n<strong>collection：collection</strong> 集合，可以为 List,Set,Map。<br>\n<strong>item</strong>： 每次遍历，index 对应的 对象。<br>\n<strong>index</strong>： 当前数组的下标<br>\n<strong> open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt;</strong> ：循环开始前加 ‘(’，循环结束后加 ‘)’。循环过程中，每次循环结束后加，。</p>\n</blockquote>\n<p>以下为官网案例：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;selectPostIn&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;domain.blog.Post&quot;</span>&gt;</span></span><br><span class=\"line\">  SELECT *</span><br><span class=\"line\">  FROM POST P</span><br><span class=\"line\">  WHERE ID in</span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">foreach</span> <span class=\"attr\">item</span>=<span class=\"string\">&quot;item&quot;</span> <span class=\"attr\">index</span>=<span class=\"string\">&quot;index&quot;</span> <span class=\"attr\">collection</span>=<span class=\"string\">&quot;list&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">open</span>=<span class=\"string\">&quot;(&quot;</span> <span class=\"attr\">separator</span>=<span class=\"string\">&quot;,&quot;</span> <span class=\"attr\">close</span>=<span class=\"string\">&quot;)&quot;</span>&gt;</span></span><br><span class=\"line\">        #&#123;item&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">foreach</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a class=\"markdownIt-Anchor\" href=\"#\">#</a> </h3>\n",
            "tags": [
                "mybatis"
            ]
        }
    ]
}